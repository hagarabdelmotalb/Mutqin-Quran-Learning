<div class="notifications-container">
  <div class="header">
    <h2 class="title">Notifications</h2>
    <div class="header-actions">
      <button 
        class="filter-btn" 
        (click)="toggleUnreadOnly()"
        [class.active]="showUnreadOnly"
        title="Toggle unread only">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M9 12l2 2 4-4"/>
          <path d="M21 12c0 4.97-4.03 9-9 9s-9-4.03-9-9 4.03-9 9-9 9 4.03 9 9z"/>
        </svg>
        {{ showUnreadOnly ? 'Show All' : 'Unread Only' }}
        <span *ngIf="unreadNotifications.length > 0" class="unread-badge">{{ unreadNotifications.length }}</span>
      </button>
      
      <button 
        class="mark-all-btn" 
        (click)="markAllAsRead()"
        [disabled]="unreadNotifications.length === 0"
        title="Mark all as read">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M9 12l2 2 4-4"/>
          <path d="M21 12c0 4.97-4.03 9-9 9s-9-4.03-9-9 4.03-9 9-9 9 4.03 9 9z"/>
        </svg>
        Mark All Read
      </button>
      
      <button 
        class="refresh-btn" 
        (click)="refreshData()" 
        [disabled]="loading"
        title="Refresh data">
        <svg class="refresh-icon" [class.spinning]="loading" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"/>
          <path d="M21 3v5h-5"/>
          <path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"/>
          <path d="M3 21v-5h5"/>
        </svg>
        {{ loading ? 'Loading...' : 'Refresh' }}
      </button>
    </div>
  </div>

  <!-- Loading State -->
  <div *ngIf="loading" class="loading-state">
    <div class="spinner"></div>
    <p>Loading notifications...</p>
  </div>

  <!-- Error State -->
  <div *ngIf="error && !loading" class="error-state">
    <div class="error-icon">‚ö†Ô∏è</div>
    <p class="error-message">{{ error }}</p>
    <button class="retry-btn" (click)="refreshData()">Try Again</button>
  </div>

  <!-- Notifications List -->
  <div *ngIf="!loading && !error && getDisplayedNotifications().length > 0" class="notifications-list">
    <div *ngFor="let notification of getDisplayedNotifications()" 
         class="notification-card"
         [class.unread]="!notification.isRead">
      
      <div class="notification-header">
        <div class="notification-info">
          <h3 class="notification-title">{{ notification.user.username }}</h3>
          <span class="notification-id">ID: {{ notification.id }}</span>
        </div>
        
        <div class="notification-actions">
          <button 
            *ngIf="!notification.isRead"
            class="mark-read-btn" 
            (click)="markAsRead(notification.id)"
            title="Mark as read">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M9 12l2 2 4-4"/>
              <path d="M21 12c0 4.97-4.03 9-9 9s-9-4.03-9-9 4.03-9 9-9 9 4.03 9 9z"/>
            </svg>
          </button>
          
          <div class="read-status" [class.read]="notification.isRead">
            {{ notification.isRead ? 'Read' : 'Unread' }}
          </div>
        </div>
      </div>
      
      <div class="notification-content">
        <p class="notification-message">{{ notification.message }}</p>
      </div>
      
      <div class="notification-footer">
        <div class="notification-date">
          <span class="date-label">Created:</span>
          <span class="date-value">{{ formatDate(notification.createdAt) }}</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Empty State -->
  <div *ngIf="!loading && !error && getDisplayedNotifications().length === 0" class="empty-state">
    <div class="empty-icon">üîî</div>
    <h3>{{ showUnreadOnly ? 'No Unread Notifications' : 'No Notifications' }}</h3>
    <p *ngIf="showUnreadOnly">All notifications have been read!</p>
    <p *ngIf="!showUnreadOnly">No notifications found for user: <strong>{{ currentUserId }}</strong></p>
    <button class="retry-btn" (click)="refreshData()">Refresh</button>
  </div>
</div>
